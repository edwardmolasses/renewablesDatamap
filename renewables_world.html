<!DOCTYPE html>
<html>
<head>
    <style>
        .active { fill: blue !important;}
        /*.datamaps-key dt, .datamaps-key dd {float: none !important;}
        .datamaps-key {right: -50px; top: 0;}*/
    </style>
</head>
<body>

<h1>Percentage of Electricity Generated by Renewables <small>(2016)</small></h1>
<div id="container1" style="border:1px dotted blue; width: 1000px; height: 800px; position: relative;"></div>

<script src="js/components/d3/d3.min.js"></script>
<script src="js/components/topojson/topojson.js"></script>
<script src="js/countryToIso2.js"></script>
<script src="js/convertIso2ToIso3.js"></script>
<script src="dist/datamaps.world.js"></script>

<script>
    // example data from server
    var series = [
        ["Albania", 100],
        ["Algeria", 0.60],
        ["Angola", 70.30],
        ["Argentina", 21.50],
        ["Armenia", 32.20],
        ["Australia", 14.50],
        ["Austria", 74.30],
        ["Azerbaijan", 8.80],
        ["Bahrain", 0.00],
        ["Bangladesh", 1.80],
        ["Belarus", 1.20],
        ["Belgium", 16.60],
        ["Benin", 3.20],
        ["Bolivia", 20.60],
        ["Bosnia and Herzegovina", 31.50],
        ["Botswana", 0.20],
        ["Brazil", 80.40],
        ["Brunei", 0.00],
        ["Bulgaria", 15.70],
        ["Cambodia", 47.20],
        ["Cameroon", 52.40],
        ["Canada", 65.00],
        ["Chile", 43.30],
        ["China", 24.50],
        ["Colombia", 62.90],
        ["Democratic Republic of the Congo", 100],
        ["Republic of the Congo", 66.40],
        ["Costa Rica", 97.70],
        ["Ivory Coast", 15.00],
        ["Croatia", 65.20],
        ["Cuba", 4.50],
        ["Cyprus", 8.70],
        ["Denmark", 60.50],
        ["Dominican Republic", 10.40],
        ["Ecuador", 60.20],
        ["Egypt", 8.20],
        ["El Salvador", 60.70],
        ["Eritrea", 0.80],
        ["Estonia", 12.50],
        ["Ethiopia", 93.60],
        ["Finland", 44.20],
        ["France", 17.50],
        ["Gabon", 68.40],
        ["Georgia", 80.70],
        ["Germany", 29.00],
        ["Ghana", 42.90],
        ["Greece", 27.40],
        ["Guatemala", 51.70],
        ["Haiti", 19.20],
        ["Honduras", 50.10],
        ["Hungary", 10.10],
        ["Iceland", 100.00],
        ["India", 12.80],
        ["Indonesia", 15.90],
        ["Iran", 5.80],
        ["Iraq", 6.40],
        ["Ireland", 24.70],
        ["Israel", 2.50],
        ["Italy", 37.30],
        ["Jamaica", 8.20],
        ["Japan", 15.00],
        ["Jordan", 4.90],
        ["Kazakhstan", 11.30],
        ["Kenya", 90.70],
        ["Korea DPR", 75.70],
        ["Korea Rep", 2.80],
        ["Kuwait", 0.10],
        ["Kyrgyzstan", 86.70],
        ["Laos", 53.10],
        ["Latvia", 54.20],
        ["Lebanon", 2.80],
        ["Libya", 0.00],
        ["Lithuania", 49.40],
        ["Luxembourg", 20.80],
        ["Macedonia", 36.70],
        ["Malaysia", 13.70],
        ["Malta", 15.60],
        ["Mauritius", 21.80],
        ["Mexico", 15.30],
        ["Moldova", 5.30],
        ["Mongolia", 3.90],
        ["Montenegro", 58.80],
        ["Morocco", 14.80],
        ["Mozambique", 83.70],
        ["Myanmar", 52.80],
        ["Namibia", 99.30],
        ["Nepal", 65.50],
        ["Netherlands", 12.10],
        ["New Zealand", 83.90],
        ["Nicaragua", 53.30],
        ["Niger", 2.50],
        ["Nigeria", 18.60],
        ["Norway", 97.20],
        ["Oman", 0.00],
        ["Pakistan", 32.70],
        ["Panama", 66.60],
        ["Paraguay", 100],
        ["Peru", 50.10],
        ["Philippines", 24.30],
        ["Poland", 13.70],
        ["Portugal", 53.50],
        ["Qatar", 0.30],
        ["Romania", 41.40],
        ["Russia", 16.90],
        ["Saudi Arabia", 0.00],
        ["Senegal", 10.40],
        ["Serbia", 27.60],
        ["Singapore", 1.60],
        ["Slovakia", 24.50],
        ["Slovenia", 30.60],
        ["South Africa", 3.20],
        ["Spain", 38.10],
        ["Sri Lanka", 27.70],
        ["Sudan", 56.70],
        ["Suriname", 58.30],
        ["Sweden", 57.10],
        ["Switzerland", 59.80],
        ["Syria", 5.30],
        ["Tajikistan", 97.50],
        ["Tanzania", 37.10],
        ["Taiwan", 4.20],
        ["Thailand", 13.10],
        ["Togo", 73.10],
        ["Trinidad and Tobago", 0.00],
        ["Tunisia", 3.00],
        ["Turkey", 32.90],
        ["Turkmenistan", 0.00],
        ["Ukraine", 5.60],
        ["United Arab Emirates", 0.30],
        ["United Kingdom", 27.90],
        ["United States", 14.70],
        ["Uruguay", 100],
        ["Uzbekistan", 25.60],
        ["Venezuela", 67.60],
        ["Vietnam", 38.60],
        ["Yemen", 10.90],
        ["Zambia", 95.00],
        ["Zimbabwe", 51.90]
    ];

    series = series.map(function(countryArr) {
        return [convertIso2ToIso3(countryToIso2(countryArr[0])), countryArr[1]];
    });

    // Datamaps expect data in format:
    // { "USA": { "fillColor": "#42a844", numberOfWhatever: 75},
    //   "FRA": { "fillColor": "#8dc386", numberOfWhatever: 43 } }
    var dataset = {};

    // We need to colorize every country based on "numberOfWhatever"
    // colors should be uniq for every value.
    // For this purpose we create palette(using min/max series-value)
    var onlyValues = series.map(function(obj){ return obj[1]; });
    var minValue = Math.min.apply(null, onlyValues),
            maxValue = Math.max.apply(null, onlyValues);

    // create color palette function
    // color can be whatever you wish
    var paletteScale = d3.scale.linear()
            .domain([minValue,maxValue])
            .range(["#EFEFFF","#02386F"]); // blue color

    // fill dataset in appropriate format
    series.forEach(function(item){ //
        // item example value ["USA", 70]
        var iso = item[0],
                value = item[1];
        dataset[iso] = { numberOfThings: value, fillColor: paletteScale(value) };
    });

    // render map
    new Datamap({
        element: document.getElementById('container1'),
        projection: 'mercator', // big world map
        // countries don't listed in dataset will be painted with this color
        fills: { defaultFill: '#F5F5F5' },
        data: dataset,
        geographyConfig: {
            borderColor: '#DEDEDE',
            highlightBorderWidth: 2,
            // don't change color on mouse hover
            highlightFillColor: function(geo) {
                return geo['fillColor'] || '#F5F5F5';
            },
            // only change border
            highlightBorderColor: '#B7B7B7',
            // show desired information in tooltip
            popupTemplate: function(geo, data) {
                // don't show tooltip if country don't present in dataset
                if (!data) { return ; }
                // tooltip content
                return ['<div class="hoverinfo">',
                    '<strong>', geo.properties.name, '</strong>',
                    '<br>Renewables: <strong>', data.numberOfThings, '%</strong>',
                    '</div>'].join('');
            }
        }
    });
</script>
<div>
    <a href="https://en.wikipedia.org/wiki/List_of_countries_by_electricity_production_from_renewable_sources">
        (source: <i>Wikipedia</i>)
    </a>
</div>

</body>
</html>